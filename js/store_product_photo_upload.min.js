document.addEventListener("DOMContentLoaded",init,!1);var AttachmentArray=[],arrCounter=0,filesCounterAlertStatus=!1,ul=document.createElement("ul");function init(){document.querySelector("#files").addEventListener("change",handleFileSelect,!1)}function handleFileSelect(e){if(e.target.files){for(var files=e.target.files,i=0,f;f=files[i];i++){var fileReader=new FileReader;fileReader.onload=function(readerEvt){return function(e){ApplyFileValidationRules(readerEvt),RenderThumbnail(e,readerEvt),FillAttachmentArray(e,readerEvt)}}(f),fileReader.readAsDataURL(f)}document.getElementById("files").addEventListener("change",handleFileSelect,!1)}}function ApplyFileValidationRules(readerEvt){return 0==CheckFileType(readerEvt.type)?(alert("The file ("+readerEvt.name+") does not match the upload conditions, You can only upload jpg/png/gif files"),void e.preventDefault()):0==CheckFileSize(readerEvt.size)?(alert("The file ("+readerEvt.name+") does not match the upload conditions, The maximum file size for uploads should not exceed 500 KB"),void e.preventDefault()):0==CheckFilesCount(AttachmentArray)?(filesCounterAlertStatus||(filesCounterAlertStatus=!0,alert("You have added more than 10 files. According to conditions you can upload 10 files maximum")),void e.preventDefault()):void 0}function CheckFileType(fileType){return"image/jpeg"==fileType||("image/png"==fileType||"image/gif"==fileType)}function CheckFileSize(fileSize){return fileSize<5e5}function CheckFilesCount(AttachmentArray){for(var len=0,i=0;i<AttachmentArray.length;i++)void 0!==AttachmentArray[i]&&len++;return!(len>9)}function RenderThumbnail(e,readerEvt){var li=document.createElement("li");ul.appendChild(li),li.innerHTML=['<div class="img-wrap"> <span class="close"><i class="fas fa-times"></i></span><img class="thumb" src="',e.target.result,'" title="',escape(readerEvt.name),'" data-id="',readerEvt.name,'"/></div>'].join("");var div=document.createElement("div");div.className="FileNameCaptionStyle",li.appendChild(div),div.innerHTML=[readerEvt.name].join(""),document.getElementById("Filelist").insertBefore(ul,null)}function FillAttachmentArray(e,readerEvt){AttachmentArray[arrCounter]={AttachmentType:1,ObjectType:1,FileName:readerEvt.name,FileDescription:"Attachment",NoteText:"",MimeType:readerEvt.type,Content:e.target.result.split("base64,")[1],FileSizeInBytes:readerEvt.size},arrCounter+=1}ul.className="thumb-Images",ul.id="imgList",jQuery((function($){$("div").on("click",".img-wrap .close",(function(){var id=$(this).closest(".img-wrap").find("img").data("id"),elementPos=AttachmentArray.map((function(x){return x.FileName})).indexOf(id);-1!==elementPos&&AttachmentArray.splice(elementPos,1),$(this).parent().find("img").not().remove(),$(this).parent().find("div").not().remove(),$(this).parent().parent().find("div").not().remove();for(var lis=document.querySelectorAll("#imgList li"),i=0;li=lis[i];i++)""==li.innerHTML&&li.parentNode.removeChild(li)}))}));