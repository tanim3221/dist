function duallistbox(select){select.previousElementSibling&&select.previousElementSibling.id===`duallistbox_${select.id}`&&select.previousElementSibling.remove(),select.style.display="none",select.querySelectorAll("option").forEach((o,i)=>o.dataset.index=i);const icon=path=>`<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1.375em" height="1.375em" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="${path}"/></svg>`,iconR=icon("M13 17l5-5-5-5M6 17l5-5-5-5"),iconL=icon("M11 17l-5-5 5-5M18 17l-5-5 5-5"),template=`\n          <div class="duallistbox row" id="duallistbox_${select.id}">\n            <div class="col-md-4">\n            <label> All Data</label>\n              <input type="text" class="form-control form-control-sm" placeholder="Filter">\n              <select class="form-control data_show_view__" id="${select.id}_1" multiple></select>\n            </div>\n            <div class="col-md-4 button_move_select">\n                         <div class="btn-group-sm btn-group" role="group">\n                <button class="btn btn-success btn-flat move-all" type="button">Select all</button>\n                <button class="btn btn-danger btn-flat remove-all" type="button">Remove all</button>\n              </div>\n              \n              <div class="form-group full_message_body_bulk">\n                        <textarea type="text" name="full_msg" placeholder="Write message body..." rows="10" id="bulk_msg" class="form-control"></textarea>\n                    </div>\n                    \n                    <button class="btn btn-success btn-flat send_bulk_mail" type="button">\n              <i class="fa fa-check-square-o"></i>\n              <span class="send_email_sms">Send</span>\n              <span class="sending_email_sms display_none">Sending...</span>\n              </button>\n            </div>\n            <div class="col-md-4">\n            <label> Selected</label>\n              <input type="text" class="form-control form-control-sm" placeholder="Filter">\n              <select class="form-control data_show_view__" id="${select.id}_2" multiple></select>\n            </div>\n          </div>\n        `;select.insertAdjacentHTML("beforebegin",template);const wrapper=document.getElementById(`duallistbox_${select.id}`),select1=document.getElementById(`${select.id}_1`),select2=document.getElementById(`${select.id}_2`),filters=wrapper.querySelectorAll("input");select1.innerHTML=[...select.querySelectorAll("option:not(:checked)")].map(o=>o.outerHTML).join(""),select2.innerHTML=[...select.querySelectorAll("option:checked")].map(o=>o.outerHTML).join("").replace(/selected=""/g,"");const filter=(target="")=>{if(""!==target){const options=target.nextElementSibling.querySelectorAll("option");options.forEach(o=>o.removeAttribute("hidden")),options.forEach(o=>{-1===o.textContent.toLowerCase().indexOf(target.value.toLowerCase())&&o.setAttribute("hidden",!0)})}else filters.forEach(input=>filter(input))};filters.forEach(input=>input.addEventListener("keyup",()=>filter(input)));const resort=()=>{[select1,select2].forEach(el=>{el.innerHTML=[...el.options].sort((a,b)=>a.dataset.index-b.dataset.index).map(o=>o.outerHTML).join("")})},move=(src,dst,all=!0)=>{const selected=all?src.querySelectorAll("option:not([hidden]):not([disabled])"):src.selectedOptions;dst.insertAdjacentHTML("beforeend",[...selected].map(o=>(o.remove(),o.outerHTML)).join("")),resort(),update()};select1.addEventListener("change",()=>move(select1,select2,!1)),select2.addEventListener("change",()=>move(select2,select1,!1));const toggle=set=>{set?move(select1,select2,!0):move(select2,select1,!0),filter()};wrapper.addEventListener("click",e=>{e.target.closest(".move-all")&&toggle(!0),e.target.closest(".remove-all")&&toggle(!1)});const update=()=>{const selectedBefore=[...select.selectedOptions].map(o=>o.dataset.index),selectedAfter=[...select2.options].map(o=>o.dataset.index);selectedBefore.join("")!==selectedAfter.join("")&&(select.querySelectorAll("option").forEach(o=>{selectedAfter.includes(o.dataset.index)?o.selected=!0:o.selected=!1}),select.dispatchEvent(new Event("change")))}}